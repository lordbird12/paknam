<div class="flex flex-col flex-auto min-w-0">
    <!-- Header -->
    <!-- Loader -->
    <div class="absolute inset-x-0 bottom-0" *ngIf="isLoading">
        <mat-progress-bar [mode]="'indeterminate'"></mat-progress-bar>
    </div>
    <!-- <div
        class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between p-6 sm:py-8 sm:px-10 border-b bg-card dark:bg-transparent">
        <div class="flex-1 flemin-w-0">

        </div>
    </div> -->

    <!-- Main -->
    <div class="flex-auto p-6 sm:p-10">
        <div class="grid gap-4 w-full sm:grid-cols-1">

            <form class="bg-card rounded-lg md:shadow overflow-hidden px-8 pt-6 pb-8 mb-4 flex flex-col my-2"
                [formGroup]="form">
                <div class="flex flex-row my-5 justify-between">
                    <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate">
                        แก้ไขตู้เก็บสินค้า
                    </h2>
                </div>
                <div class="-mx-3 md:flex mb-5">
                    <div class="md:w-1/2 px-3 mb-6 md:mb-0">
                        <mat-form-field [ngClass]="formFieldHelpers" class="w-full">
                            <mat-label>ชื่อตู้เก็บสินค้า</mat-label>
                            <input matInput [placeholder]="'กรอกชื่อตู้เก็บสินค้า'" formControlName="name">
                        </mat-form-field>
                    </div>
                </div>
                <div class="-mx-3 md:flex mb-2">
                    <div class="md:w-1/2 px-3 mb-6 md:mb-0">
                        <mat-form-field [ngClass]="formFieldHelpers" class="w-full">
                            <mat-label>รายละเอียด</mat-label>
                            <input matInput [placeholder]="'กรอกรายละเอียด'" formControlName="detail">
                        </mat-form-field>
                    </div>
                </div>
                <!-- <div class="md:w-full px-3">
                    <mat-radio-group aria-labelledby="example-radio-group-label" class="example-radio-group"
                        formControlName="status">
                        <mat-radio-button class="example-radio-button" *ngFor="let item of status" [color]="'primary'"
                            [value]="item.id">
                            {{item.name}}
                        </mat-radio-button>
                    </mat-radio-group>
                </div> -->
                <div class="flex justify-end mt-5">
                    <button class="px-6 ml-3" mat-flat-button [color]="'primary'">
                        บันทึก
                    </button>
                    <button class="px-6 ml-3" mat-flat-button [color]="'warn'">
                        ยกเลิก
                    </button>
                </div>
            </form>
        </div>
    </div>
    <div class="relative overflow-x-auto shadow-md sm:rounded-lg mx-10 mb-10  bg-white">
        <div class="flex-auto">
            <div class="flex items-center justify-end w-full border-t px-10 py-4">
                <div class="flex items-center justify-end">
                    <button class="px-6 mat-primary" mat-flat-button (click)="newFloor('1')">
                        <mat-icon svgIcon="heroicons_solid:plus"></mat-icon>
                        เพิ่มชั้น
                    </button>
                </div>
            </div>
            <div class="flex items-center justify-end w-full  px-5 py-4 mb-50">
                <div class="flex flex-col flex-auto p-5 overflow-hidden sm:overflow-y-auto">
                    <table class="w-full text-m text-left text-gray-500 dark:text-gray-400">
                        <thead
                            class="text-lx text-center text-white uppercase bg-gray-500 dark:bg-gray-700 dark:text-gray-400 h-10">
                            <tr>
                                <th>
                                    <button mat-button (click)="expandFunction()">
                                        <mat-icon class="text-white"
                                            svgIcon="heroicons_outline:chevron-right"></mat-icon>
                                    </button>
                                </th>
                                <th>ลำดับ</th>
                                <th>ชื่อตู้</th>
                                <th>ชื่อชั้น</th>
                                <th>รายละเอียด</th>
                                <th>วันที่สร้าง</th>
                                <th>จัดการ</th>
                            </tr>
                        </thead>
                        <ng-container *ngFor="let item of dataRow; let i = index">
                            <tbody *ngIf="dataRow?.length != 0">
                                <tr
                                    class="bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 text-center">
                                    <td style="width: 5%" (click)="
                                        dataRow[i].channels.isExpanded =
                                          !dataRow[i].channels.isExpanded
                                      ">
                                        <i *ngIf="!dataRow[i].channels.isExpanded"><mat-icon
                                                svgIcon="heroicons_outline:chevron-right"></mat-icon></i>
                                        <i *ngIf="dataRow[i].channels.isExpanded"><mat-icon
                                                svgIcon="heroicons_outline:chevron-up"></mat-icon></i>
                                    </td>
                                    <td style="width: 5%">
                                        {{i + 1}}
                                    </td>
                                    <td style="width: 15%">{{ this.itemData.name }}</td>
                                    <td style="width: 15%">{{ item?.name }}</td>
                                    <td style="width: 20%">
                                        {{ item?.detail}}
                                    </td>
                                    <td>
                                        {{ item?.created_at | date : "dd-MM-yyyy hh:mm a " }}
                                    </td>
                                    <td style="width: 15%">
                                        <button mat-button (click)="newChanel(item)">
                                            <mat-icon svgIcon="library_add"></mat-icon>
                                        </button>
                                        <button mat-button (click)="editData(item)">
                                            <mat-icon>edit</mat-icon>
                                        </button>
                                    </td>
                                </tr>
                                <ng-container *ngIf="dataRow[i].channels.isExpanded">
                                    <tr
                                        class="text-lx text-center text-white uppercase bg-gray-400 dark:bg-gray-700 dark:text-gray-400 h-10">
                                        <th></th>
                                        <th>ลำดับ</th>
                                        <th>ชื่อชั้น</th>
                                        <th>ชื่อช่อง</th>
                                        <th>รายละเอียด</th>
                                        <th>วันที่สร้าง</th>
                                        <th>จัดการ</th>
                                    </tr>
                                    <tr class="text-lx text-center text-gray-700 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-400 h-10  border-b"
                                        *ngFor="
                                        let chanel of dataRow[i].channels;
                                        let j = index
                                      ">
                                        <td style="width: 5%">

                                        </td>
                                        <td style="width: 5%">
                                            {{j + 1}}
                                        </td>
                                        <td style="width: 15%">{{ dataRow[i].name }}</td>
                                        <td style="width: 15%">{{ chanel?.name }}</td>
                                        <td style="width: 20%">
                                            {{ chanel?.detail}}
                                        </td>
                                        <td>
                                            {{ chanel?.created_at | date : "dd-MM-yyyy hh:mm a " }}
                                        </td>
                                        <td style="width: 15%">
                                            <button mat-button (click)="editChanel(chanel)">
                                                <mat-icon>edit</mat-icon>
                                            </button>
                                            <button mat-button (click)="viewProduct(chanel)">
                                                <mat-icon>visibility</mat-icon>
                                            </button>
                                        </td>
                                    </tr>
                                    <tr class="text-lx text-center text-gray-700 uppercase bg-gray-100 dark:bg-gray-700 dark:text-gray-400 h-10  border-b"
                                        *ngIf="dataRow[i]?.channels.length == 0">
                                        <td colspan="7">
                                            ไม่มีข้อมูลช่อง
                                        </td>

                                    </tr>

                                </ng-container>
                            </tbody>
                        </ng-container>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
